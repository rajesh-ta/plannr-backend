services:
  - type: web
    name: plannr-backend
    runtime: python
    region: oregon # change to your preferred region
    plan: free # or "starter", "standard", etc.
    rootDir: . # path relative to repo root; adjust if monorepo

    buildCommand: pip install -r requirements.txt
    startCommand: uvicorn app.main:app --host 0.0.0.0 --port $PORT

    # Run DB migrations automatically before each deploy
    preDeployCommand: alembic upgrade head

    envVars:
      - key: DATABASE_URL
        sync: false # set manually in Render dashboard (from your Render Postgres)
      - key: SECRET_KEY
        generateValue: true # Render auto-generates a secure random value
      - key: GOOGLE_CLIENT_ID
        sync: false # set manually in Render dashboard
      - key: CORS_ORIGINS
        sync: false # set to your frontend URL, e.g. https://your-app.amplifyapp.com
